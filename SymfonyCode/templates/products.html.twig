{% extends "base.html.twig" %}
{% block title %}Produits{% endblock %}
{% block body %}

{% for message in app.flashes('success') %}
        <div class="flash-notification" style="position: fixed;
                                          top: 20px;
                                          left: 50%;
                                          transform: translateX(-50%);
                                          background: #568facff;
                                          color: white;
                                          padding: 15px;
                                          border-radius: 5px;
                                          z-index: 1000;
                                          display: flex;
                                          align-items: center;
                                          gap: 10px;">
            {{ message }}
            <button onclick="this.parentElement.remove()" 
                    style="margin-left: 15px;
                           background: white;
                           color: #568facff;
                           border: none;
                           border-radius: 3px;
                           padding: 3px 8px;
                           cursor: pointer;">
                OK
            </button>
        </div>
{% endfor %}

<section class="sub-header">
        <nav>
            <a href="/home"><img src="images/4bois1.jpeg"></a>
            <div class="nav-links" id="nav-links">
                <i class="fa fa-times" onclick="hideMenu()"></i>
                <ul>
                    <li><a href="/home">ACCUEIL</a></li>
                    <li><a href="/aboutUs">À PROPOS</a></li>
                    <li><a href="/products">PRODUITS</a></li>
                    <li><a href="/panier">PANIER</a></li>
                    <li><a href="/contactUs">CONTACT</a></li>
                    
                    {% if app.user %}
                        <li class="nav-item">
                            <span class="nav-link" style="color: white !important;"><i class="bi bi-person-circle me-1"></i>{{ app.user.username }}</span> 
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ path('app_logout_check') }}"><i class="bi bi-box-arrow-right me-1"></i>DÉCONNEXION</a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link" href="/login"><i class="bi bi-box-arrow-in-right me-1"></i>CONNEXION</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
            <i class="fa fa-bars" onclick="showMenu()"></i>
        </nav>
</section>

<p style="text-align: center;">
   - <strong>680 DH</strong> correspond à un produit de dimensions 280 cm (longueur) × 210 cm (largeur) × 0,8 cm (épaisseur)<br>
   - <strong>950 DH</strong> correspond à un produit de dimensions 280 cm (longueur) × 210 cm (largeur) × 1,8 cm (épaisseur)
</p>


<!-- produits -->
<section class="produits" id="produits">
    {% if produits is defined and produits|length > 0 %}
        {% for produit in produits|batch(3) %}
            <div class="row">
                {% for item in produit %}
                    <div class="produit-item{% if loop.index == 2 %}-col1{% elseif loop.index == 3 %}-col2{% endif %}">
                        <div class="produit-hover-container">
                            <img src="{{ asset('uploads/' ~ item.imageProduitAvant) }}" 
                                 alt="{{ item.nomProduit }}" 
                                 class="produit-image-front">
                            <img src="{{ asset('uploads/' ~ item.imageProduitApres) }}" 
                                 alt="{{ item.nomProduit }} (vue arrière)" 
                                 class="produit-image-hover">
                        </div>
                        <p>{{ item.nomProduit }}</p>
                        <p>Prix: {{ item.prixProduit }}DH</p>

                        <form action="{{ path('panier_ajouter') }}" method="POST" class="add-to-cart-form">
                            <input type="hidden" name="nom_produit" value="{{ item.nomProduit }}">
                            <input type="hidden" name="prix_produit" value="{{ item.prixProduit }}">
                            <input type="hidden" name="produit_id" value="{{ item.id }}">
                            <button type="submit" class="btn-panier">Ajouter au panier</button>
                        </form>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% else %}
        <p class="text-center">Aucun produit disponible pour le moment.</p>
    {% endif %}
</section>



<style>
/*------------ Produits page -----------*/
.produits {
    width: 80%;
    margin: auto;
    text-align: center;
    padding-top: 0;
}

.produits .row {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 30px;
    margin-top: 25px;
}

/* Conteneur principal du produit */
.produit-item,
.produit-item-col1,
.produit-item-col2 {
    flex: 0 1 calc(33.333% - 30px);
    box-sizing: border-box;
    border-radius: 10px;
    margin-bottom: 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Conteneur d'images avec effet hover */
.produit-hover-container {
    position: relative;
    width: 95%;
    height: 200px;
    margin-bottom: 15px;
}

/* Images avant/arrière */
.produit-hover-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    transition: opacity 0.4s ease-out;
    position: absolute;
    top: 0;
    left: 0;
}

/* Image arrière (hover) cachée par défaut */
.produit-image-hover {
    opacity: 0;
}

/* Effet hover */
.produit-item:hover .produit-image-hover,
.produit-item-col1:hover .produit-image-hover,
.produit-item-col2:hover .produit-image-hover {
    opacity: 1;
}

.produit-item:hover .produit-image-front,
.produit-item-col1:hover .produit-image-front,
.produit-item-col2:hover .produit-image-front {
    opacity: 0;
}

/* Bouton Ajouter au panier */
.btn-panier {
    background-color: #5fa9cdff;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    margin-top: 10px;
}

.btn-panier:hover {
    background-color: #568facff;
}

/* Message quand aucun produit */
.text-center {
    text-align: center;
    width: 100%;
}
</style>

{% endblock %}